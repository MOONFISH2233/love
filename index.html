<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç»™å¦ˆå¦ˆ Â· çˆ±çš„è®°å¿†</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Ma+Shan+Zheng&family=Noto+Serif+SC:wght@300;400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Noto Serif SC', serif;
            background: linear-gradient(135deg, #fff5e6 0%, #ffe8d6 50%, #ffd8b3 100%);
            color: #5a3921;
            min-height: 100vh;
            overflow-x: hidden;
            line-height: 1.8;
        }
        
        /* èŠ±ç“£èƒŒæ™¯ */
        .petals-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }
        
        .petal {
            position: absolute;
            background: rgba(255, 182, 193, 0.5);
            border-radius: 50% 0 50% 0;
            pointer-events: none;
        }
        
        /* ä¸»å®¹å™¨ */
        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 40px 20px;
            position: relative;
            z-index: 3;
        }
        
        /* æ ‡é¢˜ */
        .header {
            text-align: center;
            margin-bottom: 60px;
            position: relative;
            padding-top: 20px;
        }
        
        .header h1 {
            font-family: 'Ma Shan Zheng', cursive;
            font-size: 4rem;
            margin-bottom: 10px;
            color: #d2691e;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
        }
        
        .header h2 {
            font-size: 1.5rem;
            color: #8b4513;
            font-weight: 300;
            margin-bottom: 30px;
        }
        
        .title-divider {
            width: 150px;
            height: 3px;
            background: linear-gradient(90deg, transparent, #d2691e, transparent);
            margin: 20px auto;
            border-radius: 3px;
        }
        
        /* å¼•è¨€éƒ¨åˆ† */
        .intro-section {
            background: rgba(255, 255, 255, 0.85);
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 40px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
            border: 1px solid rgba(210, 105, 30, 0.2);
        }
        
        .intro-text {
            font-size: 1.2rem;
            line-height: 2;
            text-align: center;
            color: #5a3921;
        }
        
        .heart-icon {
            color: #ff6b8b;
            margin: 0 10px;
            animation: heartbeat 1.5s infinite;
            display: inline-block;
        }
        
        @keyframes heartbeat {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.2); }
        }
        
        /* ç‰¹åˆ«ç…§ç‰‡å±•ç¤ºåŒº */
        .special-photo-section {
            margin-bottom: 50px;
            text-align: center;
        }
        
        .special-title {
            font-size: 2rem;
            color: #8b4513;
            margin-bottom: 30px;
            position: relative;
        }
        
        .special-title::after {
            content: '';
            display: block;
            width: 100px;
            height: 2px;
            background: linear-gradient(90deg, transparent, #d2691e, transparent);
            margin: 10px auto;
        }
        
        .special-photo-container {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
            border: 1px solid rgba(210, 105, 30, 0.2);
            transition: all 0.3s ease;
        }
        
        .special-photo-container:hover {
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.12);
            transform: translateY(-5px);
        }
        
        .special-photo {
            width: 300px;
            height: 300px;
            margin: 0 auto 20px;
            border-radius: 50%;
            overflow: hidden;
            border: 5px solid rgba(210, 105, 30, 0.3);
            box-shadow: 0 0 40px rgba(0, 0, 0, 0.15);
            position: relative;
            transition: all 0.5s ease;
        }
        
        .special-photo:hover {
            border-color: rgba(210, 105, 30, 0.7);
            transform: scale(1.03);
        }
        
        #specialPhoto {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.5s ease;
        }
        
        .special-photo:hover #specialPhoto {
            transform: scale(1.1);
        }
        
        .photo-memory {
            font-size: 1.1rem;
            color: #5a3921;
            line-height: 1.6;
            max-width: 600px;
            margin: 0 auto;
            font-style: italic;
        }
        
        /* ç…§ç‰‡ä¸Šä¼ åŒº */
        .upload-section {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 50px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
            border: 2px dashed #ffb6c1;
            text-align: center;
            transition: all 0.3s ease;
        }
        
        .upload-section:hover {
            border-color: #d2691e;
            background: rgba(255, 255, 255, 0.95);
        }
        
        .upload-title {
            font-size: 1.8rem;
            color: #8b4513;
            margin-bottom: 20px;
        }
        
        .upload-instruction {
            color: #5a3921;
            margin-bottom: 25px;
            font-size: 1.1rem;
        }
        
        /* ä¸Šä¼ æŒ‰é’®æ ·å¼ */
        .upload-btn {
            display: inline-block;
            background: linear-gradient(135deg, #ffb6c1, #ff8c94);
            color: white;
            padding: 15px 40px;
            font-size: 1.2rem;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
            box-shadow: 0 5px 15px rgba(255, 182, 193, 0.4);
            font-family: 'Noto Serif SC', serif;
            margin-bottom: 20px;
        }
        
        .upload-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(255, 182, 193, 0.6);
            background: linear-gradient(135deg, #ff8c94, #ff6b7a);
        }
        
        .upload-btn i {
            margin-right: 10px;
        }
        
        .upload-note {
            font-size: 0.9rem;
            color: #8b4513;
            font-style: italic;
            margin-top: 15px;
        }
        
        /* ç…§ç‰‡å±•ç¤ºåŒº */
        .gallery-section {
            margin-bottom: 60px;
        }
        
        .gallery-title {
            font-size: 2rem;
            color: #8b4513;
            text-align: center;
            margin-bottom: 30px;
            position: relative;
        }
        
        .gallery-title::after {
            content: '';
            display: block;
            width: 100px;
            height: 2px;
            background: linear-gradient(90deg, transparent, #d2691e, transparent);
            margin: 10px auto;
        }
        
        .gallery-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 25px;
            margin-top: 30px;
        }
        
        .photo-card {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
            transition: all 0.4s ease;
            position: relative;
            opacity: 0;
            transform: translateY(20px);
            animation: fadeInUp 0.8s forwards;
        }
        
        .photo-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.15);
        }
        
        @keyframes fadeInUp {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .photo-img {
            width: 100%;
            height: 200px;
            object-fit: cover;
            transition: transform 0.5s ease;
        }
        
        .photo-card:hover .photo-img {
            transform: scale(1.05);
        }
        
        .photo-caption {
            padding: 15px;
            text-align: center;
            color: #5a3921;
            font-size: 1rem;
        }
        
        .delete-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(0, 0, 0, 0.5);
            color: white;
            border: none;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            opacity: 0;
        }
        
        .photo-card:hover .delete-btn {
            opacity: 1;
        }
        
        .delete-btn:hover {
            background: rgba(220, 53, 69, 0.8);
        }
        
        /* ä¿¡æ¯å¡ç‰‡ */
        .info-cards {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 30px;
            margin-bottom: 60px;
        }
        
        .info-card {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            padding: 30px;
            width: 300px;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.08);
            border-top: 5px solid #ffb6c1;
            transition: all 0.3s ease;
        }
        
        .info-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 25px rgba(0, 0, 0, 0.12);
        }
        
        .info-card i {
            font-size: 2.5rem;
            color: #d2691e;
            margin-bottom: 20px;
            display: block;
            text-align: center;
        }
        
        .info-card h3 {
            font-size: 1.5rem;
            color: #8b4513;
            margin-bottom: 15px;
            text-align: center;
        }
        
        .info-card p {
            color: #5a3921;
            line-height: 1.6;
            text-align: center;
        }
        
        /* ç¥ç¦è¯­åŒºåŸŸ */
        .message-section {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 60px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
            border-left: 5px solid #d2691e;
        }
        
        .message-title {
            font-size: 2rem;
            color: #8b4513;
            margin-bottom: 30px;
            text-align: center;
        }
        
        .message-content {
            font-size: 1.2rem;
            line-height: 2;
            color: #5a3921;
            text-align: center;
            max-width: 800px;
            margin: 0 auto;
        }
        
        .signature {
            text-align: right;
            font-style: italic;
            color: #8b4513;
            margin-top: 30px;
            font-size: 1.3rem;
        }
        
        /* åº•éƒ¨ */
        .footer {
            text-align: center;
            padding: 30px 0;
            color: #8b4513;
            font-size: 0.9rem;
            border-top: 1px solid rgba(210, 105, 30, 0.2);
            margin-top: 60px;
        }
        
        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
            .header h1 {
                font-size: 3rem;
            }
            
            .header h2 {
                font-size: 1.2rem;
            }
            
            .intro-section, .upload-section, .message-section {
                padding: 25px;
            }
            
            .special-photo {
                width: 250px;
                height: 250px;
            }
            
            .gallery-container {
                grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
                gap: 15px;
            }
            
            .info-cards {
                flex-direction: column;
                align-items: center;
            }
            
            .info-card {
                width: 100%;
                max-width: 400px;
            }
        }
        
        /* åŠ è½½åŠ¨ç”» */
        .loading {
            display: none;
            text-align: center;
            margin: 20px 0;
        }
        
        .loading-dot {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #ffb6c1;
            margin: 0 5px;
            animation: loading 1.4s infinite ease-in-out both;
        }
        
        .loading-dot:nth-child(1) { animation-delay: -0.32s; }
        .loading-dot:nth-child(2) { animation-delay: -0.16s; }
        
        @keyframes loading {
            0%, 80%, 100% { transform: scale(0); }
            40% { transform: scale(1); }
        }
        
        /* èŠ±ç“£åŠ¨ç”» */
        @keyframes float {
            0%, 100% { transform: translateY(0) rotate(var(--rotation)); }
            25% { transform: translateY(-20px) translateX(10px) rotate(calc(var(--rotation) + 90deg)); }
            50% { transform: translateY(-40px) translateX(-10px) rotate(calc(var(--rotation) + 180deg)); }
            75% { transform: translateY(-20px) translateX(5px) rotate(calc(var(--rotation) + 270deg)); }
        }
    </style>
</head>
<body>
    <!-- èŠ±ç“£èƒŒæ™¯ -->
    <div class="petals-container" id="petals"></div>
    
    <!-- ä¸»å†…å®¹ -->
    <div class="container">
        <header class="header">
            <h1>ç»™å¦ˆå¦ˆ</h1>
            <h2>æœ€æ¸©æš–çš„æ¸¯æ¹¾ Â· æœ€æ— ç§çš„çˆ±</h2>
            <div class="title-divider"></div>
        </header>
        
        <section class="intro-section">
            <div class="intro-text">
                <p>å¦ˆå¦ˆï¼Œæ‚¨æ˜¯ä¸–ç•Œä¸Šæœ€æ¸©æš–çš„å…‰ <span class="heart-icon">â¤</span></p>
                <p>æ‚¨ç”¨çˆ±ç¼–ç»‡äº†æˆ‘ç”Ÿå‘½ä¸­æœ€ç¾çš„ç¯‡ç« </p>
                <p>è¿™ä¸ªå°å°çš„ç©ºé—´ï¼Œåªæƒ³è®°å½•ä¸æ‚¨çš„æ¯ä¸€ä¸ªçè´µç¬é—´</p>
            </div>
        </section>
        
        <!-- ç‰¹åˆ«ç…§ç‰‡å±•ç¤ºåŒº -->
        <section class="special-photo-section">
            <h2 class="special-title">çè—çš„å›å¿†</h2>
            <div class="special-photo-container">
                <div class="special-photo">
                    <img id="specialPhoto" src="https://i.ibb.co/210XWyVb/IMG-20190617-013918.jpg" 
                         alt="ä¸å¦ˆå¦ˆçš„çè´µåˆå½±">
                </div>
                <p class="photo-memory">
                    è¿™æ˜¯æˆ‘æœ€çè—çš„ä¸€å¼ ç…§ç‰‡ï¼Œè®°å½•äº†æˆ‘ä»¬ä¸€èµ·çš„ç¾å¥½æ—¶å…‰ã€‚<br>
                    æ¯æ¬¡çœ‹åˆ°è¿™å¼ ç…§ç‰‡ï¼Œéƒ½è®©æˆ‘æƒ³èµ·æ‚¨æ¸©æš–çš„æ€€æŠ±å’Œæ— å°½çš„çˆ±ã€‚
                </p>
            </div>
        </section>
        
        <!-- ç…§ç‰‡ä¸Šä¼ åŒº -->
        <section class="upload-section">
            <h2 class="upload-title">ğŸ“¸ ä¸Šä¼ æˆ‘ä»¬çš„ç¾å¥½å›å¿†</h2>
            <p class="upload-instruction">ä¸Šä¼ æ›´å¤šç…§ç‰‡ï¼Œè®°å½•æˆ‘ä»¬ä¸€èµ·çš„æ¸©é¦¨æ—¶å…‰</p>
            
            <button class="upload-btn" id="uploadButton">
                <i class="fas fa-cloud-upload-alt"></i> é€‰æ‹©ç…§ç‰‡ä¸Šä¼ 
            </button>
            <input type="file" id="fileInput" accept="image/*" multiple style="display: none;">
            
            <div class="loading" id="loadingIndicator">
                <div class="loading-dot"></div>
                <div class="loading-dot"></div>
                <div class="loading-dot"></div>
            </div>
            
            <p class="upload-note">ç…§ç‰‡å°†ä¿å­˜åœ¨æ‚¨çš„æµè§ˆå™¨ä¸­ï¼Œä»…æ‚¨å¯è§</p>
        </section>
        
        <!-- ç…§ç‰‡å±•ç¤ºåŒº -->
        <section class="gallery-section" id="gallerySection">
            <h2 class="gallery-title">æˆ‘ä»¬çš„æ¸©é¦¨å›å¿†</h2>
            <div class="gallery-container" id="galleryContainer">
                <!-- ç…§ç‰‡ä¼šåŠ¨æ€æ·»åŠ åˆ°è¿™é‡Œ -->
                <div class="empty-message" id="emptyMessage" style="text-align: center; grid-column: 1 / -1; padding: 40px; color: #8b4513; font-size: 1.1rem;">
                    <i class="fas fa-images" style="font-size: 3rem; margin-bottom: 20px; display: block; opacity: 0.5;"></i>
                    <p>è¿˜æ²¡æœ‰ä¸Šä¼ æ›´å¤šç…§ç‰‡ï¼Œç‚¹å‡»ä¸Šæ–¹æŒ‰é’®ä¸Šä¼ å§ï¼</p>
                </div>
            </div>
        </section>
        
        <!-- ä¿¡æ¯å¡ç‰‡ -->
        <section class="info-cards">
            <div class="info-card">
                <i class="fas fa-heart"></i>
                <h3>æ— ç§çš„çˆ±</h3>
                <p>æ‚¨çš„çˆ±åƒé˜³å…‰ï¼Œæ¸©æš–æˆ‘æˆé•¿çš„æ¯ä¸€æ­¥ã€‚æ— è®ºæˆ‘åœ¨å“ªé‡Œï¼Œéƒ½èƒ½æ„Ÿå—åˆ°æ‚¨çš„å…³æ€€ã€‚</p>
            </div>
            
            <div class="info-card">
                <i class="fas fa-hands-helping"></i>
                <h3>æ°¸æ’çš„å®ˆæŠ¤</h3>
                <p>ä»è¹’è·šå­¦æ­¥åˆ°å±•ç¿…é«˜é£ï¼Œæ‚¨å§‹ç»ˆæ˜¯æˆ‘æœ€åšå®çš„åç›¾ï¼Œæœ€æ¸©æš–çš„æ¸¯æ¹¾ã€‚</p>
            </div>
            
            <div class="info-card">
                <i class="fas fa-star"></i>
                <h3>æœ€ç¾çš„æ¦œæ ·</h3>
                <p>æ‚¨çš„å–„è‰¯ã€åšéŸ§å’Œæ™ºæ…§ï¼Œæ˜¯æˆ‘ä¸€ç”Ÿå­¦ä¹ çš„æ¦œæ ·ï¼Œæ˜¯æˆ‘å¿ƒä¸­æœ€ç¾çš„é£æ™¯ã€‚</p>
            </div>
        </section>
        
        <!-- ç¥ç¦è¯­åŒºåŸŸ -->
        <section class="message-section">
            <h2 class="message-title">ç»™å¦ˆå¦ˆçš„è¯</h2>
            <div class="message-content">
                <p>äº²çˆ±çš„å¦ˆå¦ˆï¼š</p>
                <p>æ—¶å…‰èè‹’ï¼Œå²æœˆå¦‚æ¢­ã€‚è½¬çœ¼é—´ï¼Œæˆ‘å·²é•¿å¤§ï¼Œè€Œæ‚¨çš„é¬“è§’ä¹Ÿæ·»äº†ç™½å‘ã€‚</p>
                <p>æ„Ÿè°¢æ‚¨ç»™äºˆæˆ‘ç”Ÿå‘½ï¼Œæ•™ä¼šæˆ‘æˆé•¿ï¼Œç”¨æ— å°½çš„çˆ±åŒ…å®¹æˆ‘çš„ä¸€åˆ‡ã€‚</p>
                <p>æ‚¨æ˜¯æˆ‘äººç”Ÿè·¯ä¸Šæœ€äº®çš„ç¯å¡”ï¼Œæ˜¯æˆ‘ç–²æƒ«æ—¶æœ€æ¸©æš–çš„æ€€æŠ±ã€‚</p>
                <p>æ„¿æ—¶å…‰å–„å¾…æ‚¨ï¼Œæ„¿å¥åº·å¸¸ä¼´æ‚¨ï¼Œæ„¿ç¬‘å®¹æ°¸é©»æ‚¨çš„è„¸åºã€‚</p>
                <p>å¦ˆå¦ˆï¼Œæˆ‘çˆ±æ‚¨ï¼Œä¸ä»…åœ¨ä»Šå¤©ï¼Œåœ¨æœªæ¥çš„æ¯ä¸€å¤©ã€‚</p>
            </div>
            <div class="signature">
                <p>â€”â€” æ°¸è¿œçˆ±æ‚¨çš„é¦™è¢œå­</p>
            </div>
        </section>
        
        <footer class="footer">
            <p>â¤ï¸ çŒ®ç»™ä¸–ç•Œä¸Šæœ€ä¼Ÿå¤§çš„å¦ˆå¦ˆ â¤ï¸</p>
            <p style="margin-top:10px; font-size:0.8rem; opacity:0.7;">æ‰€æœ‰ç…§ç‰‡ä»…ä¿å­˜åœ¨æ‚¨çš„è®¾å¤‡ä¸­ï¼Œä¿æŠ¤æ‚¨çš„éšç§</p>
        </footer>
    </div>

    <script>
        // åˆ›å»ºèŠ±ç“£èƒŒæ™¯
        function createPetals() {
            const petalsContainer = document.getElementById('petals');
            const petalCount = 25;
            
            for (let i = 0; i < petalCount; i++) {
                const petal = document.createElement('div');
                petal.classList.add('petal');
                
                // éšæœºå¤§å°ã€ä½ç½®å’Œé¢œè‰²
                const size = Math.random() * 30 + 10;
                const x = Math.random() * 100;
                const y = Math.random() * 100;
                const hue = Math.random() * 30 + 330; // ç²‰è‰²ç³»
                const saturation = Math.random() * 30 + 70;
                const lightness = Math.random() * 20 + 70;
                const rotation = Math.random() * 360;
                const opacity = Math.random() * 0.4 + 0.3;
                
                petal.style.width = `${size}px`;
                petal.style.height = `${size}px`;
                petal.style.left = `${x}%`;
                petal.style.top = `${y}%`;
                petal.style.backgroundColor = `hsla(${hue}, ${saturation}%, ${lightness}%, ${opacity})`;
                petal.style.setProperty('--rotation', `${rotation}deg`);
                
                // èŠ±ç“£é£˜è½åŠ¨ç”»
                const duration = 15 + Math.random() * 20;
                const delay = Math.random() * 10;
                
                petal.style.animation = `float ${duration}s ease-in-out ${delay}s infinite`;
                
                petalsContainer.appendChild(petal);
            }
        }
        
        // ç…§ç‰‡ç®¡ç†åŠŸèƒ½
        let photos = [];
        
        // ä»æœ¬åœ°å­˜å‚¨åŠ è½½ç…§ç‰‡
        function loadPhotosFromStorage() {
            try {
                const savedPhotos = localStorage.getItem('momPhotos');
                if (savedPhotos) {
                    photos = JSON.parse(savedPhotos);
                    renderGallery();
                }
            } catch (error) {
                console.log('æ— æ³•åŠ è½½ä¿å­˜çš„ç…§ç‰‡:', error);
                photos = [];
            }
        }
        
        // ä¿å­˜ç…§ç‰‡åˆ°æœ¬åœ°å­˜å‚¨
        function savePhotosToStorage() {
            try {
                localStorage.setItem('momPhotos', JSON.stringify(photos));
            } catch (error) {
                console.log('æ— æ³•ä¿å­˜ç…§ç‰‡ï¼ˆå¯èƒ½è¶…å‡ºå­˜å‚¨é™åˆ¶ï¼‰:', error);
                alert('å­˜å‚¨ç©ºé—´å·²æ»¡ï¼Œè¯·åˆ é™¤ä¸€äº›ç…§ç‰‡å†è¯•ã€‚');
            }
        }
        
        // æ¸²æŸ“ç›¸å†Œ
        function renderGallery() {
            const galleryContainer = document.getElementById('galleryContainer');
            const emptyMessage = document.getElementById('emptyMessage');
            
            if (photos.length === 0) {
                emptyMessage.style.display = 'block';
                return;
            }
            
            emptyMessage.style.display = 'none';
            
            // æ¸…ç©ºç°æœ‰å†…å®¹ï¼ˆé™¤äº†ç©ºæ¶ˆæ¯ï¼‰
            Array.from(galleryContainer.children).forEach(child => {
                if (child.id !== 'emptyMessage') {
                    child.remove();
                }
            });
            
            // æ·»åŠ ç…§ç‰‡å¡ç‰‡
            photos.forEach((photo, index) => {
                const photoCard = document.createElement('div');
                photoCard.className = 'photo-card';
                photoCard.style.animationDelay = `${index * 0.1}s`;
                
                photoCard.innerHTML = `
                    <button class="delete-btn" data-index="${index}">
                        <i class="fas fa-times"></i>
                    </button>
                    <img src="${photo.dataUrl}" alt="å›å¿†ç…§ç‰‡" class="photo-img">
                    <div class="photo-caption">
                        <p>${photo.caption || 'ç¾å¥½å›å¿†'}</p>
                        <small>${photo.date || getCurrentDate()}</small>
                    </div>
                `;
                
                galleryContainer.appendChild(photoCard);
            });
            
            // æ·»åŠ åˆ é™¤äº‹ä»¶ç›‘å¬
            document.querySelectorAll('.delete-btn').forEach(btn => {
                btn.addEventListener('click', function(e) {
                    e.stopPropagation();
                    const index = parseInt(this.getAttribute('data-index'));
                    deletePhoto(index);
                });
            });
        }
        
        // åˆ é™¤ç…§ç‰‡
        function deletePhoto(index) {
            if (confirm('ç¡®å®šè¦åˆ é™¤è¿™å¼ ç…§ç‰‡å—ï¼Ÿ')) {
                photos.splice(index, 1);
                savePhotosToStorage();
                renderGallery();
                
                // æ˜¾ç¤ºåˆ é™¤æˆåŠŸæç¤º
                showNotification('ç…§ç‰‡å·²åˆ é™¤');
            }
        }
        
        // è·å–å½“å‰æ—¥æœŸ
        function getCurrentDate() {
            const now = new Date();
            return `${now.getFullYear()}å¹´${now.getMonth() + 1}æœˆ${now.getDate()}æ—¥`;
        }
        
        // ä¸Šä¼ ç…§ç‰‡åŠŸèƒ½
        document.getElementById('uploadButton').addEventListener('click', function() {
            document.getElementById('fileInput').click();
        });
        
        document.getElementById('fileInput').addEventListener('change', function(event) {
            const files = event.target.files;
            if (!files || files.length === 0) return;
            
            const loadingIndicator = document.getElementById('loadingIndicator');
            loadingIndicator.style.display = 'block';
            
            // å¤„ç†æ¯å¼ å›¾ç‰‡
            const filePromises = [];
            for (let i = 0; i < Math.min(files.length, 10); i++) {
                filePromises.push(processImageFile(files[i]));
            }
            
            // æ‰€æœ‰å›¾ç‰‡å¤„ç†å®Œæˆå
            Promise.all(filePromises)
                .then(results => {
                    results.forEach(result => {
                        if (result) {
                            photos.unshift(result); // æ–°ç…§ç‰‡æ”¾åœ¨æœ€å‰é¢
                        }
                    });
                    
                    savePhotosToStorage();
                    renderGallery();
                    
                    // æ˜¾ç¤ºä¸Šä¼ æˆåŠŸæç¤º
                    showNotification(`æˆåŠŸä¸Šä¼  ${results.length} å¼ ç…§ç‰‡`);
                })
                .catch(error => {
                    console.error('å›¾ç‰‡å¤„ç†é”™è¯¯:', error);
                    alert('ä¸Šä¼ å¤±è´¥ï¼Œè¯·é‡è¯•ã€‚');
                })
                .finally(() => {
                    loadingIndicator.style.display = 'none';
                    document.getElementById('fileInput').value = '';
                });
        });
        
        // å¤„ç†å›¾ç‰‡æ–‡ä»¶
        function processImageFile(file) {
            return new Promise((resolve, reject) => {
                // æ£€æŸ¥æ–‡ä»¶ç±»å‹
                if (!file.type.match('image.*')) {
                    alert(`æ–‡ä»¶ "${file.name}" ä¸æ˜¯å›¾ç‰‡æ ¼å¼ï¼Œå·²è·³è¿‡ã€‚`);
                    resolve(null);
                    return;
                }
                
                // æ£€æŸ¥æ–‡ä»¶å¤§å°ï¼ˆé™åˆ¶ä¸º5MBï¼‰
                if (file.size > 5 * 1024 * 1024) {
                    alert(`æ–‡ä»¶ "${file.name}" å¤ªå¤§ï¼ˆè¶…è¿‡5MBï¼‰ï¼Œå·²è·³è¿‡ã€‚`);
                    resolve(null);
                    return;
                }
                
                const reader = new FileReader();
                
                reader.onload = function(e) {
                    const img = new Image();
                    
                    img.onload = function() {
                        // åˆ›å»ºCanvaså‹ç¼©å›¾ç‰‡
                        const canvas = document.createElement('canvas');
                        const ctx = canvas.getContext('2d');
                        
                        // è®¡ç®—æ–°å°ºå¯¸ï¼ˆé™åˆ¶æœ€å¤§å®½åº¦/é«˜åº¦ä¸º1200pxï¼‰
                        let width = img.width;
                        let height = img.height;
                        const maxSize = 1200;
                        
                        if (width > height && width > maxSize) {
                            height = (height * maxSize) / width;
                            width = maxSize;
                        } else if (height > maxSize) {
                            width = (width * maxSize) / height;
                            height = maxSize;
                        }
                        
                        canvas.width = width;
                        canvas.height = height;
                        
                        // ç»˜åˆ¶å¹¶å‹ç¼©
                        ctx.drawImage(img, 0, 0, width, height);
                        
                        // è·å–å‹ç¼©åçš„æ•°æ®URL
                        const compressedDataUrl = canvas.toDataURL('image/jpeg', 0.8);
                        
                        // åˆ›å»ºç…§ç‰‡å¯¹è±¡
                        const photo = {
                            id: Date.now() + Math.random(),
                            name: file.name,
                            size: file.size,
                            date: getCurrentDate(),
                            caption: file.name.replace(/\.[^/.]+$/, ""), // å»æ‰æ‰©å±•åä½œä¸ºé»˜è®¤æè¿°
                            dataUrl: compressedDataUrl
                        };
                        
                        resolve(photo);
                    };
                    
                    img.onerror = reject;
                    img.src = e.target.result;
                };
                
                reader.onerror = reject;
                reader.readAsDataURL(file);
            });
        }
        
        // æ˜¾ç¤ºé€šçŸ¥
        function showNotification(message) {
            // ç§»é™¤æ—§çš„é€šçŸ¥
            const oldNotification = document.querySelector('.notification');
            if (oldNotification) oldNotification.remove();
            
            // åˆ›å»ºæ–°é€šçŸ¥
            const notification = document.createElement('div');
            notification.className = 'notification';
            notification.textContent = message;
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: #d2691e;
                color: white;
                padding: 15px 25px;
                border-radius: 10px;
                box-shadow: 0 5px 15px rgba(0,0,0,0.2);
                z-index: 1000;
                animation: slideIn 0.3s ease, fadeOut 0.3s ease 2.7s forwards;
            `;
            
            // æ·»åŠ åŠ¨ç”»
            const style = document.createElement('style');
            style.textContent = `
                @keyframes slideIn {
                    from { transform: translateX(100%); opacity: 0; }
                    to { transform: translateX(0); opacity: 1; }
                }
                @keyframes fadeOut {
                    from { opacity: 1; }
                    to { opacity: 0; }
                }
            `;
            document.head.appendChild(style);
            
            document.body.appendChild(notification);
            
            // 3ç§’åè‡ªåŠ¨ç§»é™¤
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.remove();
                    style.remove();
                }
            }, 3000);
        }
        
        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        window.addEventListener('DOMContentLoaded', function() {
            createPetals();
            loadPhotosFromStorage();
            
            // é¡µé¢åŠ è½½åŠ¨ç”»
            document.body.style.opacity = '0';
            document.body.style.transition = 'opacity 1s ease';
            
            setTimeout(() => {
                document.body.style.opacity = '1';
            }, 100);
            
            // ä¸ºç‰¹åˆ«ç…§ç‰‡æ·»åŠ åŠ è½½åŠ¨ç”»
            const specialPhoto = document.getElementById('specialPhoto');
            specialPhoto.style.opacity = '0';
            specialPhoto.style.transform = 'scale(0.9)';
            
            specialPhoto.onload = function() {
                setTimeout(() => {
                    specialPhoto.style.transition = 'all 0.8s ease';
                    specialPhoto.style.opacity = '1';
                    specialPhoto.style.transform = 'scale(1)';
                }, 500);
            };
            
            // å¦‚æœå›¾ç‰‡å·²ç»ç¼“å­˜ï¼Œç«‹å³è§¦å‘æ•ˆæœ
            if (specialPhoto.complete) {
                specialPhoto.onload();
            }
            
            // æ·»åŠ ä¸€äº›æç¤º
            setTimeout(() => {
                if (photos.length === 0) {
                    showNotification('ç‚¹å‡»"é€‰æ‹©ç…§ç‰‡ä¸Šä¼ "æŒ‰é’®æ·»åŠ æ›´å¤šç…§ç‰‡');
                }
            }, 2000);
        });
    </script>
</body>
</html>

